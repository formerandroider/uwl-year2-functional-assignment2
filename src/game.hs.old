import System.IO 

game :: IO ()
game = do putStrLn "You are in the entrance lobby. There is a door to your east. The exit to your south is locked..."
          putStr "direction> "
          direction <- getLine
          play (Location ["entrance"]) direction

play :: Location -> String -> IO ()
play location direction =
   do
      if direction == "quit" then
         putStrLn "You give yourself as a sacrifice to the mansion... you are swallowed whole and never seen again."
      else
         do putStrLn (match location direction)
            play direction

match :: Location -> String -> String -> String
match xs ys = description xs ys

data Location = Location [String]

addLocation :: String -> Location -> Location
addLocation l (Location []) = Location (l:[])
addLocation l (Location ls) = Location (l:ls)

description :: Location -> String -> String -> String
description Location("entrance") "s" _ = "You can't go that way... the exit is locked."
description ["entrance"] "e" "enter" =
	"You are in the east room... there is a scroll on the wall. The scroll reads \"The key is located in Room B, the password is 'Key needed. Give!'\"." ++
	"\nThere is a door to your east and north. The door you just entered has mysteriously vanished..."
description ["entrance"] "e" _ = "This door needs a password... you didn't enter the correct one."
--description "w" "room1" =
--    "You are in a room1.  To the north is the dark mouth\n" ++
--    "of a room2; to the south is a small room5.  Your\n" ++
--    "assignment, should you decide to accept it, is to\n" ++
--    "recover the famed Bar-Abzad ruby and return it to\n" ++
--    "this room3."
--description "w" "room2" = "Congratulations!!  You have recovered the ruby and won the game."
--description "s" "room1" =
--    "You are in the mouth of a dank room2.  The exit is to\n" ++
--    "the south; there is a large, dark, round passage to\n" ++
--    "the east."
--description "s" "room4"= "you are inside room4"
--description _ _ = "you can't see anything."




